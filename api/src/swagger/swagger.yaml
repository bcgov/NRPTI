swagger: '2.0'
info:
  version: '0.0.0'
  title: NRPTI API
host: localhost:3000
basePath: /api
tags:
  - name: 'search'
    description: 'Search operations'
    externalDocs:
      description: 'Find out more about our API'
      url: 'https://github.com/bcgov/NRPTI.git'
  - name: 'record'
    description: 'Operations on Record objects'
    externalDocs:
      description: 'Find out more about our API'
      url: 'https://github.com/bcgov/NRPTI.git'
  - name: 'task'
    description: 'Operations on tasks'
    externalDocs:
      description: 'Find out more about our API'
      url: 'http://github.com/bcgov/nrptiapi.git'
schemes:
  - http
securityDefinitions:
  Bearer:
    type: apiKey
    name: Authorization
    in: header
    description: |
      For accessing the API, a valid JWT token must be passed in all the queries in
      the 'Authorization' header.

      A valid JWT token is generated by the API automatically via redirect through Keycloak.

      The following syntax must be used in the 'Authorization' header: Bearer xxxxxx.yyyyyyy.zzzzzz

consumes:
  - application/json
produces:
  - application/json

definitions:
  ### Record Type Definitions
  RecordRequestObject:
    type: object
  RecordResponseObject:
    type: object
  dataSourceType:
    type: string
    description: 'Supported data sources'
    example: 'epic'
    enum: &dataSourceType
      - core
      - core-documents
      - epic
      - nris-epd
      - nris-emli
      - coors-csv
      - bcogc
  dataImportType:
    type: string
    description: 'Supported import task types'
    example: 'import'
    enum: &dataImportType
      - import
      - csvImport
      - updateMaterializedView
  materializedViewSubset:
    type: string
    description: 'Supported subsets'
    example: 'issuedTo'
    enum: &materializedViewSubset
      - issuedTo
      - location
      - recordName
      - descriptionSummary
      - outcomeDescription
  recordType:
    type: string
    description: 'Supported record types'
    example: 'Order'
    enum: &recordType
      - AdministrativePenalty
      - AdministrativeSanction
      - Agreement
      - Certificate
      - Collection
      - ConstructionPlan
      - CourtConviction
      - Inspection
      - ManagementPlan
      - Mine
      - Order
      - Permit
      - RestorativeJustice
      - SelfReport
      - Ticket
      - Warning

  ### Collection Type Definitions
  CollectionRequestObject:
    type: object

  ### Map Info Type Definitions
  MapInfoRequestObject:
    type: object

  ### News Type Definitions
  NewsRequestObject:
    type: object

  ### Miness Type Definitions
  MineRequestObject:
    type: object

  ### Document Type Definitions
  DocumentRequestObject:
    type: object
  DocumentResponseObject:
    type: object
    properties:
      signedUrl:
        type: string
        example: 'A pre-signed URL.'

  ### Config Definitions
  ConfigObject:
    type: object

  ### Metric Definitions
  MetricListObject:
    type: object

  ### Search Definitions
  SearchObject:
    type: object
    properties:
      keywords:
        type: string
        example: 'Project Name'
  SearchDataSetParams:
    type: string
    description: 'Optional datasets to search on in the DB'
    example: ['Order']
    enum: &searchDataSetParams
      - AdministrativePenalty
      - AdministrativeSanction
      - Agreement
      - Certificate
      - Collection
      - ConstructionPlan
      - CourtConviction
      - Inspection
      - ManagementPlan
      - Mine
      - Order
      - Permit
      - RestorativeJustice
      - SelfReport
      - Ticket
      - Warning
  SearchSubsetParams:
    type: string
    description: 'Optional datasets to search on in the DB'
    example: ['description']
    enum: &SearchSubsetParams
      - description
      - dateIssued
      - location
      - recordName
      - issuedTo
      - outcomeDescription
  SearchSortByFields:
    type: string
    description: 'Optional fields to sort by (prefixed with + or - for order)'
    example: +dateAdded,-startDate
    enum: &searchSortByFields
      - +dateIssued
      - -dateIssued
      - +dateAdded
      - -dateAdded
      - +startDate
      - -startDate
      - +displayName
      - -displayName
      - +documentType
      - -documentType

  ### Config Data Definition
  ConfigData:
    type: object

  ### Task Definitions
  TaskObject:
    type: object
    example: 'A task object'
    required: [dataSourceType]
    properties:
      params:
        type: object
        example: '{"dateSince": "30-10-2019"}'
      dataSourceType:
        type: string
        description: 'The datasource to update'
        example: 'epic'
        enum: *dataSourceType
      taskType:
        type: string
        description: 'The type of task'
        example: 'import'
        enum: *dataImportType
      recordTypes:
        type: array
        description: 'Specific record types to update.  If not provided, all supported types will be updated.'
        items:
          type: string
          enum: *recordType
      csvData:
        type: string
        description: 'Data for csv imports'
      materializedViewSubset:
        type: string
        description: 'Name of subset to update'
        example: 'issuedTo'
        enum: *materializedViewSubset

  ### Common Definitions
  Token:
    type: object
    properties:
      token:
        type: string

  Error:
    type: object
    properties:
      message:
        type: string

  UpdateAgencyObject:
    type: object

paths:
  /config:
    x-swagger-router-controller: config
    options:
      tags:
        - config
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on config Route'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/ConfigObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - config
      summary: 'Get the app configuration'
      operationId: publicGetConfig
      description: 'Retrieves configuration data.'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/ConfigObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /config/{app}:
    x-swagger-router-controller: config
    options:
      tags:
        - config
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on config Route'
      parameters:
        - name: app
          in: path
          description: 'Specific application/business area you want to fetch configurations for'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/ConfigObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - config
      summary: 'Get the app configuration'
      operationId: publicGetConfig
      description: 'Retrieves configuration data.'
      parameters:
        - name: app
          in: path
          description: 'Specific application/business area you want to fetch configurations for'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/ConfigObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - config
      summary: 'Create an app communication package (note: this will remove any existing package)'
      operationId: protectedPostConfig
      description: 'Authenticated access to create a communication package'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: app
          in: path
          description: 'Specific application/business area you want to fetch configurations for'
          required: true
          type: string
        - name: data
          in: body
          description: 'Create config data body'
          required: true
          schema:
            $ref: '#/definitions/ConfigData'
      responses:
        '201':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /config/{app}/{configId}:
    x-swagger-router-controller: config
    options:
      tags:
        - config
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on config Route'
      parameters:
        - name: app
          in: path
          description: 'Specific application/business area you want to fetch configurations for'
          required: true
          type: string
        - name: configId
          in: path
          description: 'Id of config'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/ConfigObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - config
      summary: 'Get the app configuration'
      operationId: protectedPutConfig
      description: 'Retrieves configuration data.'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: app
          in: path
          description: 'Specific application/business area you want to fetch configurations for'
          required: true
          type: string
        - name: configId
          in: path
          description: 'Id of config'
          required: true
          type: string
        - name: data
          in: body
          description: 'Create config data body'
          required: true
          schema:
            $ref: '#/definitions/ConfigData'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/ConfigObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /metric:
    x-swagger-router-controller: metric
    options:
      tags:
        - metric
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on metric Route'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/MetricListObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - metric
      summary: 'Get a list of metrics'
      operationId: protectedList
      description: 'Retreiving a list of metrics stored in the system.'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/MetricListObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /metric/{code}:
    x-swagger-router-controller: metric
    options:
      tags:
        - metric
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on metric Route'
      parameters:
        - name: code
          in: path
          description: 'code of metric'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/MetricListObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - metric
      summary: 'Get a metric'
      operationId: protectedGet
      description: 'Retreives a metric.'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - name: code
          in: path
          description: 'code of metric'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/MetricListObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /metric/{code}/data:
    x-swagger-router-controller: metric
    options:
      tags:
        - metric
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on metric Route'
      parameters:
        - name: code
          in: path
          description: 'code of metric'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/MetricListObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - metric
      summary: 'Get data associated with a metric'
      operationId: protectedGetData
      description: "Retreives data from a metric after it's aggregation is run."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - name: code
          in: path
          description: 'code of metric'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/MetricListObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /search:
    x-swagger-router-controller: search
    options:
      tags:
        - search
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on search Route'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/SearchObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - search
      summary: 'Get a list of things related to these keywords'
      operationId: protectedGet
      description: 'Retreiving items relating to the given keywords.'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - in: query
          name: _id
          description: 'Grab (via _id) specific document'
          type: string
          required: false
          items:
            type: string
        - in: query
          name: keywords
          description: 'Full Text Search based on keywords'
          type: string
          required: false
          collectionFormat: pipes
          items:
            type: string
        - in: query
          name: populate
          description: 'Populate Project object ID'
          type: boolean
          required: false
        - in: query
          name: dataset
          description: 'Dataset to search on'
          type: array
          items:
            type: string
            enum: *searchDataSetParams
          required: false
        - in: query
          name: _schemaName
          description: 'Schema to search on'
          type: string
          required: false
        - in: query
          name: project
          description: 'Project to specifically query'
          type: string
          required: false
        - in: query
          name: pageNum
          description: 'Page number to skip to.'
          type: number
          required: false
        - in: query
          name: pageSize
          description: '# Records to limit'
          type: number
          required: false
        - in: query
          name: sortBy
          description: 'Fields to sort by.'
          required: false
          type: array
          items:
            type: string
            enum: *searchSortByFields
        - in: query
          name: and
          collectionFormat: multi
          required: false
          description: 'Query: multiple parameter instances are supported using AND.'
          type: string
        - in: query
          name: or
          collectionFormat: multi
          required: false
          description: 'Query: multiple parameter instances are supported using OR.'
          type: string
        - in: query
          name: nor
          collectionFormat: multi
          required: false
          description: 'Query: multiple parameter instances are supported using NOR.'
          type: string
        - in: query
          name: _in
          collectionFormat: multi
          required: false
          description: 'Query: multiple parameter instances are supported using IN.'
          type: string
        - in: query
          name: subset
          description: 'Fields that you want to filter your keyword search on.'
          type: array
          items:
            type: string
            enum: *SearchSubsetParams
          required: false
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/SearchObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /public/search:
    x-swagger-router-controller: search
    options:
      tags:
        - search
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on search Route'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/SearchObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - search
      summary: 'Get a list of things related to these keywords'
      operationId: publicGet
      description: 'Retrieving items relating to the given keywords.'
      parameters:
        - in: query
          name: _id
          description: 'Grab (via _id) specific document'
          type: string
          required: false
          items:
            type: string
        - in: query
          name: keywords
          description: 'Full Text Search based on keywords'
          type: string
          required: false
          collectionFormat: pipes
          items:
            type: string
        - in: query
          name: populate
          description: 'Populate Project object ID'
          type: boolean
          required: false
        - in: query
          name: dataset
          description: 'Dataset to search on'
          type: array
          items:
            type: string
            enum: *searchDataSetParams
          required: false
        - in: query
          name: _schemaName
          description: 'Schema to search on'
          type: string
          required: false
        - in: query
          name: project
          description: 'Project to specifically query'
          type: string
          required: false
        - in: query
          name: pageNum
          description: 'Page number to skip to.'
          type: number
          required: false
        - in: query
          name: pageSize
          description: '# Records to limit'
          type: number
          required: false
        - in: query
          name: sortBy
          description: 'Fields to sort by.'
          required: false
          type: array
          items:
            type: string
            enum: *searchSortByFields
        - in: query
          name: and
          collectionFormat: multi
          required: false
          description: 'Query: multiple parameter instances are supported using AND.'
          type: string
        - in: query
          name: or
          collectionFormat: multi
          required: false
          description: 'Query: multiple parameter instances are supported using OR.'
          type: string
        - in: query
          name: subset
          description: 'Fields that you want to filter your keyword search on.'
          type: array
          items:
            type: string
            enum: *SearchSubsetParams
          required: false
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/SearchObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  ###
  ### Task Routes
  ###
  /task:
    x-swagger-router-controller: import-task
    options:
      tags:
        - task
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated task route'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - task
      summary: 'Create a new Task'
      operationId: protectedCreateTask
      description: 'Authenticated access to create a Task Worker'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
      parameters:
        - name: task
          in: body
          description: 'Flag to import records'
          required: true
          schema:
            $ref: '#/definitions/TaskObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  ###
  ### Record Routes
  ###
  /record/{recordId}:
    x-swagger-router-controller: record-controller
    options:
      tags:
        - record
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated record route'
      parameters:
        - name: recordId
          in: path
          description: '_id of record'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - record
      summary: 'Delete a record'
      operationId: protectedDelete
      description: "Deletes a record via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - name: recordId
          in: path
          description: '_id of record to delete'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /record/{recordId}/publish:
    x-swagger-router-controller: record-controller
    options:
      tags:
        - record
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated record route'
      parameters:
        - name: recordId
          in: path
          description: '_id of record to publish'
          required: true
          type: string
        - name: record
          in: body
          description: 'record to publish'
          required: true
          schema:
            $ref: '#/definitions/RecordRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - record
      summary: 'Publish a record'
      operationId: protectedPublish
      description: "Adds the singular instance of the 'public' role to a record."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - name: recordId
          in: path
          description: '_id of record to publish'
          required: true
          type: string
        - name: record
          in: body
          description: 'record to publish'
          required: true
          schema:
            $ref: '#/definitions/RecordRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /record/{recordId}/unpublish:
    x-swagger-router-controller: record-controller
    options:
      tags:
        - record
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated record route'
      parameters:
        - name: recordId
          in: path
          description: '_id of record to publish'
          required: true
          type: string
        - name: record
          in: body
          description: 'record to unpublish'
          required: true
          schema:
            $ref: '#/definitions/RecordRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - record
      summary: 'Unpublish a record'
      operationId: protectedUnPublish
      description: "Adds the singular instance of the 'public' role to a record."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - name: recordId
          in: path
          description: '_id of record to publish'
          required: true
          type: string
        - name: record
          in: body
          description: 'record to unpublish'
          required: true
          schema:
            $ref: '#/definitions/RecordRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /record:
    x-swagger-router-controller: record-controller
    options:
      tags:
        - task
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated task route'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - record
      summary: 'Create new record(s)'
      operationId: protectedPost
      description: 'Authenticated access to create a record'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - in: body
          name: data
          description: 'Records in an array that you would like to save'
          required: true
          schema:
            $ref: '#/definitions/RecordRequestObject'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/RecordResponseObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - record
      summary: 'Edit record(s)'
      operationId: protectedPut
      description: 'Authenticated access to create a record'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - in: body
          name: data
          description: 'Records in an array that you would like to save'
          required: true
          schema:
            $ref: '#/definitions/RecordRequestObject'
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/RecordResponseObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'

  ###
  ### Document Routes
  ###
  /record/{recordId}/document:
    x-swagger-router-controller: document-controller
    options:
      tags:
        - task
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated task route'
      parameters:
        - name: recordId
          in: path
          description: '_id of record to publish'
          required: true
          type: string
        - name: data
          in: body
          description: 'Data to create a document'
          required: true
          schema:
            $ref: '#/definitions/DocumentRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - Document
      summary: 'Create new Document(s)'
      operationId: protectedPost
      description: 'Authenticated access to create a Document and get a signed put URL in return'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      consumes:
        - multipart/form-data
      parameters:
        - name: recordId
          in: path
          description: '_id of record the document is associated with'
          required: true
          type: string
        - name: upfile
          in: formData
          description: "The file to upload. If this is present, the file will be uploaded to S3."
          required: false
          type: file
        - name: fileName
          in: formData
          description: "Filename for document/link (Only applies to links)"
          required: true
          type: string
        - name: url
          in: formData
          description: "Url for links. If this is present, a link will be created."
          required: false
          type: string
      responses:
        '200':
          description: 'Success'
          schema:
            $ref: '#/definitions/DocumentResponseObject'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /record/{recordId}/document/{docId}:
    x-swagger-router-controller: document-controller
    options:
      tags:
        - task
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated task route'
      parameters:
        - name: recordId
          in: path
          description: '_id of record'
          required: true
          type: string
        - name: docId
          in: path
          description: '_id of document'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - Document
      summary: 'Delete Document'
      operationId: protectedDelete
      description: 'Authenticated access to create a Document and get a signed put URL in return'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - name: recordId
          in: path
          description: '_id of record the document is associated with'
          required: true
          type: string
        - name: docId
          in: path
          description: '_id of document we want to delete'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /document/{docId}/signedurl:
    x-swagger-router-controller: document-controller
    options:
      tags:
        - document
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated document route'
      parameters:
        - name: docId
          in: path
          description: '_id of document to get an s3 signed url for'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - document
      summary: 'Get a signed s3 url for an uploaded document'
      operationId: protectedGetS3SignedURL
      description: 'Gets an s3 signed url for a document uploaded to s3.'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:nrced
        - admin:bcmi
        - admin:wlrs
        - admin:wf
        - admin:flnro
        - admin:agri
        - admin:env-epd
        - admin:alc
        - admin:flnr-nro
        - admin:env-cos
        - admin:env-bcparks
      parameters:
        - name: docId
          in: path
          description: '_id of document to get an s3 signed url for'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  ###
  ### News Routes
  ###
  /news/:
    x-swagger-router-controller: news-controller
    options:
      tags:
        - news
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated news route'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - news
      summary: 'Post a news'
      operationId: protectedPost
      description: "Creates a news via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: news
          in: body
          description: 'news to create'
          required: true
          schema:
            $ref: '#/definitions/NewsRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /news/{newsId}:
    x-swagger-router-controller: news-controller
    options:
      tags:
        - news
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated news route'
      parameters:
        - name: newsId
          in: path
          description: '_id of news'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - news
      summary: 'Get a news'
      operationId: protectedGet
      description: "Get a news via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: newsId
          in: path
          description: '_id of news to get'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - news
      summary: 'Put a news'
      operationId: protectedPut
      description: "Updates a news via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: newsId
          in: path
          description: '_id of news to update'
          required: true
          type: string
        - name: news
          in: body
          description: 'news to update'
          required: true
          schema:
            $ref: '#/definitions/NewsRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - news
      summary: 'Delete a news'
      operationId: protectedDelete
      description: "Deletes a news via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: newsId
          in: path
          description: '_id of news to delete'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  ###
  ### mine Routes
  ###
  /mine/:
    x-swagger-router-controller: mine-controller
    options:
      tags:
        - mine
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated mine route'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - mine
      summary: 'Post a mine'
      operationId: protectedPost
      description: "Creates a mine via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: mine
          in: body
          description: 'mine to create'
          required: true
          schema:
            $ref: '#/definitions/MineRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /mine/{mineId}:
    x-swagger-router-controller: mine-controller
    options:
      tags:
        - mine
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated mine route'
      parameters:
        - name: mineId
          in: path
          description: '_id of mine'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - mine
      summary: 'Get a mine'
      operationId: protectedGet
      description: "Get a mine via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: mineId
          in: path
          description: '_id of mine to get'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - mine
      summary: 'Put a mine'
      operationId: protectedPut
      description: "Updates a mine via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: mineId
          in: path
          description: '_id of mine to update'
          required: true
          type: string
        - name: mine
          in: body
          description: 'mine to update'
          required: true
          schema:
            $ref: '#/definitions/MineRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - mine
      summary: 'Delete a mine'
      operationId: protectedDelete
      description: "Deletes a mine via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: mineId
          in: path
          description: '_id of mine to delete'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /mine/{mineId}/publish:
    x-swagger-router-controller: mine-controller
    options:
      tags:
        - mine
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated mine route'
      parameters:
        - name: mineId
          in: path
          description: '_id of mine'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - mine
      summary: 'Put a mine'
      operationId: protectedPublish
      description: "Updates a mine via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: mineId
          in: path
          description: '_id of mine to update'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /mine/{mineId}/unpublish:
    x-swagger-router-controller: mine-controller
    options:
      tags:
        - mine
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated mine route'
      parameters:
        - name: mineId
          in: path
          description: '_id of mine'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - mine
      summary: 'Put a mine'
      operationId: protectedUnPublish
      description: "Updates a mine via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: mineId
          in: path
          description: '_id of mine to update'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  ###
  ### collection Routes
  ###
  /collection/:
    x-swagger-router-controller: collection-controller
    options:
      tags:
        - collection
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated collection route'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - collection
      summary: 'Post a collection'
      operationId: protectedPost
      description: "Creates a collection via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: collection
          in: body
          description: 'collection to create'
          required: true
          schema:
            $ref: '#/definitions/CollectionRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /collection/{collectionId}:
    x-swagger-router-controller: collection-controller
    options:
      tags:
        - collection
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated collection route'
      parameters:
        - name: collectionId
          in: path
          description: '_id of collection'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
        - collection
      summary: 'Get a collection'
      operationId: protectedGet
      description: "Get a collection via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: collectionId
          in: path
          description: '_id of collection to get'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - collection
      summary: 'Put a collection'
      operationId: protectedPut
      description: "Updates a collection via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: collectionId
          in: path
          description: '_id of collection to update'
          required: true
          type: string
        - name: collection
          in: body
          description: 'collection to update'
          required: true
          schema:
            $ref: '#/definitions/CollectionRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - collection
      summary: 'Delete a collection'
      operationId: protectedDelete
      description: "Deletes a collection via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:nrced
        - admin:lng
        - admin:bcmi
        - admin:wlrs
      parameters:
        - name: collectionId
          in: path
          description: '_id of collection to delete'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  ###
  ### map layer info Routes
  ###
  /map-info:
    x-swagger-router-controller: map-info-controller
    options:
      tags:
        - map-info
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated map-info route'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - map-info
      summary: 'Post a map info'
      operationId: protectedPost
      description: "Creates a new map info"
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:wlrs
      parameters:
        - name: mapInfo
          in: body
          description: 'Map info to create'
          required: true
          schema:
            $ref: '#/definitions/MapInfoRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'    
  /map-info/{mapInfoId}:
    x-swagger-router-controller: map-info-controller
    options:
      tags:
        - map-info
      summary: 'Pre-flight request'
      operationId: protectedOptions
      description: 'Options on authenticated map info route'
      parameters:
        - name: mapInfoId
          in: path
          description: '_id of map info'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
        - map-info
      summary: 'Put a map info'
      operationId: protectedPut
      description: "Updates a map info via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:wlrs
      parameters:
        - name: mapInfoId
          in: path
          description: '_id of map info to update'
          required: true
          type: string
        - name: mapInfo
          in: body
          description: 'map info to update'
          required: true
          schema:
            $ref: '#/definitions/MapInfoRequestObject'
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - map-info
      summary: 'Delete a map info'
      operationId: protectedDelete
      description: "Deletes a map info via _id."
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:wlrs
      parameters:
        - name: mapInfoId
          in: path
          description: '_id of map info to delete'
          required: true
          type: string
      responses:
        '200':
          description: 'Success'
        '403':
          description: 'Access Denied'
          schema:
            $ref: '#/definitions/Error'
  /list-agencies:
    x-swagger-router-controller: agencies
    options:
      tags:
        - agencies-list
      summary: 'list agencies'
      operationId: publicGet
      responses:
        '200':
          description: "Success"
        '403':
          description: 'Access Denied'
    get:
      tags:
        - agencies-list
      summary: 'list agencies'
      operationId: publicGet
      responses:
        '200':
          description: "Success"
        '403':
          description: 'Access Denied'
  /update-agencies:
    x-swagger-router-controller: agencies
    options:
      tags:
        - agencies-update
      summary: 'update agencies'
      operationId: protectedPut
      parameters:
        - in: body
          name: data
          description: 'Agency info to be updated'
          required: true
          schema:
            $ref: '#/definitions/UpdateAgencyObject'
      responses:
        '200':
          description: "Success"
        '403':
          description: 'Access Denied'
    put:
      tags:
        - agencies-update
      summary: 'update agencies'
      security:
        - Bearer: []
      x-security-scopes:
        - sysadmin
        - admin:lng
        - admin:wlrs
      operationId: protectedPut
      parameters:
        - in: body
          name: data
          description: 'Agency info to be updated'
          required: true
          schema:
            $ref: '#/definitions/UpdateAgencyObject'
      responses:
        '200':
          description: "Success"
        '403':
          description: 'Access Denied'
