<main class="container-fluid-padding">
  <section>
    <div class="d-flex heading-bar">
      <div>
        <h1 id="name" class="m-0">{{ (mine && mine.name) || '-' }}</h1>
      </div>
    </div>
  </section>

  <section>
    <!-- TAB HEADERS -->
    <div role="navigation">
      <ul class="nav nav-tabs nav-fill pl-2" role="tablist">
        <li class="nav-item" role="presentation">
          <a
            class="nav-link"
            role="tab"
            routerLink="/mines/{{ mine && mine._id }}/records"
            routerLinkActive
            #rla="routerLinkActive"
            [class.active]="true"
          >
            Records
          </a>
        </li>
        <li class="nav-item" role="presentation">
          <a
            class="nav-link"
            role="tab"
            routerLink="/mines/{{ mine && mine._id }}/collections"
            [class.active]="false"
          >
            Collections
          </a>
        </li>
      </ul>
    </div>
  </section>

  <section>
    <search-filter-template
      #explorePanel
      (searchEvent)='executeSearch($event)'
      title="Keyword Search"
      tooltip="Summary, description, location, and issued to name fields"
      [subsets]="subsets"
      [advancedFilters]="true"
      [showAdvancedFilters]="showAdvancedFilters"
      [searchOnFilterChange]="true"
      filterItemPanelSize="3"
      [filters]="filters">
    </search-filter-template>
  </section>

  <section class="d-flex justify-content-end">
    <div>
      <span ngbDropdown>
        <button class="btn btn-primary" id="actionDropdown" ngbDropdownToggle>Actions</button>
        <div class="dropdown-menu" aria-labelledby="actionDropdown" ngbDropdownMenu>
          <button class="dropdown-item" [disabled]="!anySelectedRecords()" (click)="submitAddEditCollectionRecords()">Add to new Collection</button>
          <button class="dropdown-item" [disabled]="!anySelectedRecords()" (click)="submitAddToExistingCollection()">Add to existing Collection</button>
        </div>
      </span>
    </div>
  </section>

  <section *ngIf="collectionState">
    <div class="d-flex justify-content-end mb-1">
      <div>
        <button
          type="button"
          class="btn btn-link"
          (click)="cancelAddEditCollectionRecords()"
          title="Cancel adding records to collection"
        >
          Cancel
        </button>
        <button
          class="btn add-records-btn border-0"
          type="submit"
          (click)="submitAddEditCollectionRecords()"
          title="Update collection with the selected records"
        >
          <i class="material-icons align-middle mr-1">
            check_circle
          </i>
          Update Collection Records
        </button>
        <span class="grey-subtext text-right d-block">
          Selected {{ collectionState.collectionRecords.length }} records.
        </span>
      </div>
    </div>
  </section>

  <section class="mb-1 pb-1">
    <div *ngIf="!tableData.totalListItems">
      No Mines found.
    </div>

    <lib-table-template
      *ngIf="tableData.totalListItems > 0"
      [data]="tableData"
      (messageOut)="onMessageOut($event)"
    ></lib-table-template>
  </section>
</main>
